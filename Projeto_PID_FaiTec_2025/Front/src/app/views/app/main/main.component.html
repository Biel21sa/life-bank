<div class="main-root">
    <!-- Toolbar aprimorada -->
    <mat-toolbar color="primary" class="modern-toolbar">
        <button mat-icon-button (click)="sidenav.toggle()" matTooltip="Menu" class="menu-button">
            <mat-icon>menu</mat-icon>
        </button>

        <div class="logo-section" routerLink="/" (click)="sidenav.close()">
            <div class="logo-icon">
                <img src="assets/img/svg/logo.svg" alt="LifeBank Logo"
                    style="width: 25px; height: 25px; margin-left: 2px;">
            </div>
            <span class="logo-title">LifeBank</span>
        </div>

        <span class="toolbar-spacer"></span>

        <div class="toolbar-actions">
            <button mat-icon-button matTooltip="Meu perfil" [matMenuTriggerFor]="myProfile" class="profile-button">
                <mat-icon>account_circle</mat-icon>
            </button>
        </div>

        <mat-menu #myProfile yPosition="below" [overlapTrigger]="false" class="profile-menu">
            <div class="profile-header">
                <mat-icon>account_circle</mat-icon>
                <div class="profile-info">
                    <span class="profile-name">{{userName}}</span>
                    <span class="profile-role">{{userRoleDisplay()}}</span>
                </div>
            </div>

            <mat-divider></mat-divider>

            <button mat-menu-item routerLink="/account/my-profile">
                <mat-icon>person</mat-icon>
                <span>Minha conta</span>
            </button>

            <mat-divider></mat-divider>

            <button mat-menu-item (click)="logout()" class="logout-item">
                <mat-icon>exit_to_app</mat-icon>
                <span>Sair</span>
            </button>
        </mat-menu>
    </mat-toolbar>

    <!-- Container principal com sidenav -->
    <mat-sidenav-container class="app-container">
        <mat-sidenav #sidenav mode="over" [class.mat-elevation-z4]="true" class="app-sidenav"
            (closed)="onSidenavClosed()">

            <!-- Header do sidenav -->
            <div class="sidenav-header">
                <div class="sidenav-logo">
                    <img src="assets/img/svg/logo.svg" alt="LifeBank Logo"
                        style="width: 30px; height: 30px; margin-right: 5px; margin-bottom: 3px;">
                    <span>LifeBank</span>
                </div>
                <p class="sidenav-subtitle">Sistema de Gestão</p>
            </div>

            <!-- Menu de navegação -->
            <mat-nav-list class="navigation-menu">
                <!-- Usuários -->
                <mat-expansion-panel *ngIf="isSystemAdmin()" [class.mat-elevation-z0]="true" class="nav-panel">
                    <mat-expansion-panel-header class="panel-header">
                        <div class="header-content">
                            <mat-icon>people</mat-icon>
                            <span>Usuários</span>
                        </div>
                    </mat-expansion-panel-header>
                    <mat-nav-list class="sub-menu">
                        <a mat-list-item routerLink="/user/list" (click)="sidenav.close()" class="sub-menu-item">
                            <mat-icon>list</mat-icon>
                            <span>Listar</span>
                        </a>
                        <a mat-list-item routerLink="/user/create" (click)="sidenav.close()" class="sub-menu-item">
                            <mat-icon>person_add</mat-icon>
                            <span>Criar</span>
                        </a>
                    </mat-nav-list>
                </mat-expansion-panel>

                <!-- Locais de Doação -->
                <mat-expansion-panel *ngIf="isSystemAdmin()" [class.mat-elevation-z0]="true" class="nav-panel">
                    <mat-expansion-panel-header class="panel-header">
                        <div class="header-content">
                            <mat-icon>add_location</mat-icon>
                            <span>Locais de Doação</span>
                        </div>
                    </mat-expansion-panel-header>
                    <mat-nav-list class="sub-menu">
                        <a mat-list-item routerLink="/donation-location/list" (click)="sidenav.close()"
                            class="sub-menu-item">
                            <mat-icon>list</mat-icon>
                            <span>Listar</span>
                        </a>
                        <a mat-list-item routerLink="/donation-location/create" (click)="sidenav.close()"
                            class="sub-menu-item">
                            <mat-icon>add_location</mat-icon>
                            <span>Criar</span>
                        </a>
                    </mat-nav-list>
                </mat-expansion-panel>

                <!-- Doadores -->
                <mat-expansion-panel *ngIf="isAdministrator()" [class.mat-elevation-z0]="true" class="nav-panel">
                    <mat-expansion-panel-header class="panel-header">
                        <div class="header-content">
                            <mat-icon>volunteer_activism</mat-icon>
                            <span>Doadores</span>
                        </div>
                    </mat-expansion-panel-header>
                    <mat-nav-list class="sub-menu">
                        <a mat-list-item routerLink="/donor/list" (click)="sidenav.close()" class="sub-menu-item">
                            <mat-icon>list</mat-icon>
                            <span>Listar</span>
                        </a>
                        <a mat-list-item routerLink="/donor/create" (click)="sidenav.close()" class="sub-menu-item">
                            <mat-icon>person_add</mat-icon>
                            <span>Criar</span>
                        </a>
                    </mat-nav-list>
                </mat-expansion-panel>

                <!-- Clínicas -->
                <mat-expansion-panel *ngIf="isUser() || isAdministrator()" [class.mat-elevation-z0]="true"
                    class="nav-panel">
                    <mat-expansion-panel-header class="panel-header">
                        <div class="header-content">
                            <mat-icon>local_hospital</mat-icon>
                            <span>Clínicas</span>
                        </div>
                    </mat-expansion-panel-header>
                    <mat-nav-list class="sub-menu">
                        <a mat-list-item routerLink="/clinic/list" (click)="sidenav.close()" class="sub-menu-item">
                            <mat-icon>list</mat-icon>
                            <span>Listar</span>
                        </a>
                        <a mat-list-item routerLink="/clinic/create" *ngIf="isAdministrator()" (click)="sidenav.close()"
                            class="sub-menu-item">
                            <mat-icon>add</mat-icon>
                            <span>Criar</span>
                        </a>
                    </mat-nav-list>
                </mat-expansion-panel>

                <!-- Doações -->
                <mat-expansion-panel *ngIf="isAdministrator()" [class.mat-elevation-z0]="true" class="nav-panel">
                    <mat-expansion-panel-header class="panel-header">
                        <div class="header-content">
                            <mat-icon>bloodtype</mat-icon>
                            <span>Doações</span>
                        </div>
                    </mat-expansion-panel-header>
                    <mat-nav-list class="sub-menu">
                        <a mat-list-item routerLink="/donation-history" (click)="sidenav.close()" class="sub-menu-item">
                            <mat-icon>history</mat-icon>
                            <span>Histórico</span>
                        </a>
                        <a mat-list-item routerLink="/donation-create" (click)="sidenav.close()" class="sub-menu-item">
                            <mat-icon>add</mat-icon>
                            <span>Registrar</span>
                        </a>
                    </mat-nav-list>
                </mat-expansion-panel>

                <!-- Estoque de Sangue -->
                <mat-expansion-panel *ngIf="isAdministrator()" [class.mat-elevation-z0]="true" class="nav-panel">
                    <mat-expansion-panel-header class="panel-header">
                        <div class="header-content">
                            <mat-icon>bar_chart</mat-icon>
                            <span>Estoque de Sangue</span>
                        </div>
                    </mat-expansion-panel-header>
                    <mat-nav-list class="sub-menu">
                        <a mat-list-item routerLink="/blood-stock" (click)="sidenav.close()" class="sub-menu-item">
                            <mat-icon>bar_chart</mat-icon>
                            <span>Estoque</span>
                        </a>
                        <a mat-list-item routerLink="/blood-withdrawal" (click)="sidenav.close()" class="sub-menu-item">
                            <mat-icon>remove_circle</mat-icon>
                            <span>Retirar Sangue</span>
                        </a>
                    </mat-nav-list>
                </mat-expansion-panel>

                <!-- Gráficos e Relatórios -->
                <mat-expansion-panel *ngIf="isAdministrator()" [class.mat-elevation-z0]="true" class="nav-panel">
                    <mat-expansion-panel-header class="panel-header">
                        <div class="header-content">
                            <mat-icon>analytics</mat-icon>
                            <span>Gráficos e Relatórios</span>
                        </div>
                    </mat-expansion-panel-header>
                    <mat-nav-list class="sub-menu">
                        <a mat-list-item routerLink="/reports" (click)="sidenav.close()" class="sub-menu-item">
                            <mat-icon>analytics</mat-icon>
                            <span>Acessar</span>
                        </a>
                    </mat-nav-list>
                </mat-expansion-panel>

                <!-- Minhas Doações -->
                <mat-expansion-panel *ngIf="isUser()" [class.mat-elevation-z0]="true" class="nav-panel">
                    <mat-expansion-panel-header class="panel-header">
                        <div class="header-content">
                            <mat-icon>favorite</mat-icon>
                            <span>Minhas Doações</span>
                        </div>
                    </mat-expansion-panel-header>
                    <mat-nav-list class="sub-menu">
                        <a mat-list-item routerLink="/my-donations" (click)="sidenav.close()" class="sub-menu-item">
                            <mat-icon>history</mat-icon>
                            <span>Histórico</span>
                        </a>
                        <a mat-list-item routerLink="/my-benefits" (click)="sidenav.close()" class="sub-menu-item">
                            <mat-icon>card_giftcard</mat-icon>
                            <span>Benefícios</span>
                        </a>
                    </mat-nav-list>
                </mat-expansion-panel>

                <!-- Benefícios -->
                <mat-expansion-panel *ngIf="isClinic()" [class.mat-elevation-z0]="true" class="nav-panel">
                    <mat-expansion-panel-header class="panel-header">
                        <div class="header-content">
                            <mat-icon>card_giftcard</mat-icon>
                            <span>Benefícios</span>
                        </div>
                    </mat-expansion-panel-header>
                    <mat-nav-list class="sub-menu">
                        <a mat-list-item routerLink="/benefit/verification" (click)="sidenav.close()"
                            class="sub-menu-item">
                            <mat-icon>verified</mat-icon>
                            <span>Verificar</span>
                        </a>
                    </mat-nav-list>
                </mat-expansion-panel>

                <mat-expansion-panel *ngIf="isClinic()" [class.mat-elevation-z0]="true" class="nav-panel">
                    <mat-expansion-panel-header class="panel-header">
                        <div class="header-content">
                            <mat-icon>support_agent</mat-icon>
                            <span>Suporte</span>
                        </div>
                    </mat-expansion-panel-header>
                    <mat-nav-list class="sub-menu">
                        <a mat-list-item routerLink="/benefit/verification" (click)="sidenav.close()"
                            class="sub-menu-item">
                            <mat-icon>chat</mat-icon>
                            <span>Chat</span>
                        </a>
                    </mat-nav-list>
                </mat-expansion-panel>
            </mat-nav-list>
        </mat-sidenav>

        <!-- Conteúdo principal -->
        <div class="page-wrap">
            <main class="container">
                <router-outlet></router-outlet>
                <div class="content-spacer"></div>
            </main>
        </div>
    </mat-sidenav-container>

    <!-- Footer aprimorado -->
    <footer class="modern-footer">
        <div class="footer-content">
            <div class="footer-info">
                <img src="assets/img/svg/logo.svg" alt="LifeBank Logo"
                    style="width: 20px; height: 20px; margin-right: -10px; margin-bottom: 5px;">
                <span>&copy; 2025 LifeBank. Todos os direitos reservados.</span>
            </div>
            <div class="footer-links">
                <span>Salvando vidas através da tecnologia</span>
            </div>
        </div>
    </footer>
</div>